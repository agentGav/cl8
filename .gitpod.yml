# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/introduction/learn-gitpod/gitpod-yaml)
# and commit this file to your remote git repository to share the goodness with others.

# Learn more from ready-to-use templates: https://www.gitpod.io/docs/introduction/getting-started/quickstart

# make sure we have access to a running version of postgres
image: gitpod/workspace-postgres

tasks:
  - name: main
    init: |
      # install just - its like make but better
      curl --proto '=https' --tlsv1.2 -sSf https://just.systems/install.sh | bash -s -- --to just-dir
      mv just-dir/just /home/gitpod/.local/bin/just
      rm -rf just-dir

      # # create database, install our dependencies, and run migrations
      cp .env.sample .env
      createdb cl8
      just install
      gp sync-done installed

  - name: tailwind
    command: |
      gp sync-await installed
      just tailwind-dev

  - name: mailhog
    command: >
      docker run
      --rm
      --name mailhog
      -p 8025:8025
      -p 1025:1025
      mailhog/mailhog
